# 单词查询功能测试指南

## 功能概述
单词查询功能允许用户在聊天消息中选择英文单词后，通过AI API获取该单词在特定上下文中的详细解释、翻译和例句。

## 测试步骤

### 1. 基本功能测试
1. 启动应用：`npm run dev`
2. 确保已配置API密钥（设置 -> API配置）
3. 在聊天界面发送一条包含英文单词的消息
4. 选中消息中的英文单词（例如：选中"hello"）
5. 应该出现蓝色的"查询单词"按钮
6. 点击按钮，应该弹出查询对话框

### 2. 查询界面测试
1. 确认对话框显示选中的单词
2. 点击"查询单词"按钮
3. 验证是否显示加载状态
4. 等待API响应并检查结果显示

### 3. 结果显示测试
预期结果应包含：
- 单词基本信息（音标、词性）
- 中文释义
- 相关例句及翻译

### 4. 错误处理测试
1. 未配置API密钥时的错误提示
2. 网络错误时的错误提示
3. API响应错误时的处理

## 实现的功能特性

### 前端功能
- **智能文本选择**：自动检测英文单词
- **悬浮查询按钮**：选择文本后自动显示
- **响应式对话框**：适配各种屏幕尺寸
- **加载状态**：查询时显示加载动画
- **错误处理**：友好的错误提示

### 后端功能
- **RESTful API**：`POST /api/word-query`
- **上下文理解**：基于选择文本的上下文提供准确解释
- **AI集成**：使用用户配置的AI服务
- **错误处理**：完善的异常处理机制

## 技术实现细节

### 组件架构
- `WordQueryDialog.jsx`：主查询对话框
- `MessageList.jsx`：支持文本选择的消息列表
- `useWordQuery.js`：前端查询服务hook

### API设计
- 端点：`/api/word-query`
- 请求格式：JSON（word, context, config）
- 响应格式：JSON（success, data/error）

### 文本选择逻辑
- 使用`window.getSelection()`获取选中文本
- 正则表达式验证英文单词
- 自动获取上下文（前后50个字符）
- 3秒自动隐藏查询按钮

## 优化建议

1. **性能优化**
   - 可以添加查询结果缓存
   - 优化选择事件的防抖处理

2. **用户体验**
   - 添加键盘快捷键支持
   - 支持双击快速查询

3. **功能扩展**
   - 支持查询历史记录
   - 添加单词收藏功能
   - 支持语音朗读

## 兼容性说明
- 支持现代浏览器（Chrome 80+, Firefox 75+, Safari 13+）
- 响应式设计，支持移动端
- 与现有聊天功能无冲突